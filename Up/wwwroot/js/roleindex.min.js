var vue=new Vue({el:"#RoleIndex",data:{title:"Quản Lý Role",messageText:"",color:"",timeout:3e3,snackbar:!1,search:"",headers:[{text:"Action",align:"left",sortable:!1,value:""},{text:"Role",value:"role",align:"left",sortable:!0}],roleItems:[],dialogEditRole:!1,dialogQuyen:!1,dialogUser:!1,itemToEdit:{},editedIndex:-1,itemQuyens:[],itemUsers:[],dialog:!1,alert:!1,newItem:"",rules:[e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Chỉ được nhập email"]},async beforeCreate(){let e=this;await axios.get("/Setting/GetRolesAsync").then(function(t){e.roleItems=t.data}).catch(function(e){console.log(e)})},methods:{async mappingUserRoleItem(e){let t=this;this.editedIndex=this.roleItems.indexOf(e),this.itemToEdit=Object.assign({},e),await axios.get("/Setting/GetQuyenByRoleIdAsync?RoleId="+e.id).then(function(e){t.itemQuyens=e.data}).catch(function(e){console.log(e)})},async mappingQuyenRoleItem(e){let t=this;this.editedIndex=this.roleItems.indexOf(e),this.itemToEdit=Object.assign({},e),await axios.get("/Setting/GetAccountByRoleNameAsync?RoleName="+e.role).then(function(e){t.itemUsers=e.data}).catch(function(e){console.log(e)})},async onUpdate(e,t){let a=this;await axios.get("/Setting/EditRoleAsync?RoleId="+e+"&Name="+t).then(function(e){console.log(e),"OK"===e.data.status?(a.snackbar=!0,a.messageText="Cập nhật thành công !!!",a.color="success"):(a.snackbar=!0,a.messageText=e.data.message,a.color="error")}).catch(function(e){console.log(e),a.snackbar=!0,a.messageText="Cập nhật lỗi: "+e,a.color="error"})},async onSave(){if(""!==this.newItem){this.dialog=!1;let e=this;await axios.get("/Setting/CreateNewRoleAsync?Name="+this.newItem).then(function(t){"OK"===t.data.status?(e.roleItems.splice(0,0,t.data.result),e.snackbar=!0,e.messageText="Tạo role thành công !!!",e.color="success"):(e.snackbar=!0,e.messageText=t.data.message,e.color="error")}).catch(function(t){console.log(t),e.snackbar=!0,e.messageText="Tạo role lỗi: "+t,e.color="error"})}else this.alert=!0},async onUpdateQuyenRole(e){var t=this;await axios({method:"put",url:"/Setting/AddQuyenToRoleAsync",data:{QuyenList:t.itemQuyens,RoleId:e.id}}).then(function(e){"OK"===e.data.status?(t.snackbar=!0,t.messageText="Cập nhật thành công !!!",t.color="success",t.dialogQuyen=!1):(t.snackbar=!0,t.messageText=e.data.message,t.color="error",t.dialogQuyen=!1)}).catch(function(e){console.log(e),t.snackbar=!0,t.messageText="Cập nhật lỗi: "+e,t.color="error",t.dialogQuyen=!1})}}});