var vue = new Vue({ el: "#ChiPhiIndex", data: { title: "Tính Lương/Chi Phí", messageText: "", color: "", timeout: 3e3, snackbar: !1, deleteDialog: !1, dialog: !1, selectedThang: "", selectedNam: "", itemThang: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"], itemKhuyenMai: ["5", "10", "15", "20", "25", "30", "35", "40", "45", "50"], itemNam: [(new Date).toISOString().substr(0, 4) - 2, (new Date).toISOString().substr(0, 4) - 1, (new Date).toISOString().substr(0, 4) - 0, parseInt((new Date).toISOString().substr(0, 4)) + 1], chiPhiList: [], headers: [{ text: "Tên", align: "left", sortable: !0 }, { text: "Chi Phí", align: "left", sortable: !0, class: "red-header" }, { text: "Số Ngày Nghỉ", align: "left", sortable: !0 }, { text: "Lương Căn Bản/Chi Phí", align: "left", sortable: !0 }, { text: "Lương Giảng Dạy/giờ", align: "left", sortable: !0 }, { text: "Lương Kèm/giờ", align: "left", sortable: !0 }, { text: "Số Giờ Dạy", align: "left", sortable: !0 }, { text: "Số Giờ Kèm", align: "left", sortable: !0 }, { text: "Hoa Hồng", align: "left", sortable: !0 }, { text: "Số HV", align: "left", sortable: !0 }, { text: "(+) Khác", align: "left", sortable: !0 }, { text: "(-) Khác", align: "left", sortable: !0 }, { text: "Ghi Chú", align: "left", sortable: !0 }] }, computed: { total() { let i = 0; for (let t of this.chiPhiList) i += 1 * t.chiPhiMoi; return i } }, methods: { async onTinhChiPhi(i) { isNaN(i.soNgayNghi) || isNaN(i.soHocVien) || isNaN(i.soGioDay) || isNaN(i.soGioKem) || isNaN(i.bonus) || isNaN(i.minus) || (Math.ceil(i.hocPhiMoi / 1e3), i.chiPhiMoi = i.salary_Expense - i.dailySalary * i.soNgayNghi + i.mucHoaHong * i.soHocVien + i.soGioKem * i.tutoringRate + i.soGioDay * i.teachingRate + 1 * i.bonus - 1 * i.minus, i.chiPhiMoi = 1e4 * Math.ceil(i.chiPhiMoi / 1e3)) }, async onTinhTien() { let i = this; "" !== this.selectedNam && "" !== this.selectedThang && ("" === this.khuyenMai && (this.khuyenMai = 0), await axios.get("/ChiPhi/GetChiPhiAsync?month=" + this.selectedThang + "&year=" + this.selectedNam).then((function (t) { i.chiPhiList = t.data.chiPhiList })).catch((function (i) { console.log(i.response.data.Message) }))) }, formatNumber: i => i.toLocaleString("it-IT", { style: "currency", currency: "VND" }), async onLuuChiPhi() { let i = this, t = 0; for (let i = 0; i < this.chiPhiList.length; i++)t += this.chiPhiList[i].chiPhiMoi, this.chiPhiList[i].year = this.selectedNam, this.chiPhiList[i].month = this.selectedThang, (isNaN(this.chiPhiList[i].bonus) || "" === this.chiPhiList[i].bonus) && (this.chiPhiList[i].bonus = 0), (isNaN(this.chiPhiList[i].minus) || "" === this.chiPhiList[i].minus) && (this.chiPhiList[i].minus = 0); await axios({ method: "post", url: "/ChiPhi/LuuChiPhiAsync", data: { models: i.chiPhiList } }).then((function (t) { if (console.log(t), "OK" === t.data.status) { i.snackbar = !0, i.messageText = "Lưu Chi Phí thành công !!!", i.color = "success"; for (let t = 0; t < i.chiPhiList.length; t++)i.chiPhiList[t].daLuu = !0 } else i.snackbar = !0, i.messageText = t.data.message, i.color = "error" })).catch((function (t) { console.log(t.response.data.Message), i.snackbar = !0, i.messageText = "Lưu Chi Phí lỗi: " + t.response.data.Message, i.color = "error" })) }, async onLuuNhapChiPhi() { let i = this, t = 0; for (let i = 0; i < this.chiPhiList.length; i++)t += this.chiPhiList[i].chiPhiMoi, this.chiPhiList[i].year = this.selectedNam, this.chiPhiList[i].month = this.selectedThang, isNaN(this.chiPhiList[i].bonus) && (this.chiPhiList[i].bonus = 0), isNaN(this.chiPhiList[i].minus) && (this.chiPhiList[i].minus = 0); await axios({ method: "post", url: "/ChiPhi/LuuNhapChiPhiAsync", data: { models: i.chiPhiList } }).then((function (t) { console.log(t), "OK" === t.data.status ? (i.snackbar = !0, i.messageText = "Lưu Bảng Tính thành công !!!", i.color = "success") : (i.snackbar = !0, i.messageText = t.data.message, i.color = "error") })).catch((function (t) { console.log(t.response.data.Message), i.snackbar = !0, i.messageText = "Lưu Bảng Tính lỗi: " + t.response.data.Message, i.color = "error" })) } } });