var vue=new Vue({el:"#AccountIndex",data:{title:"Quản Lý Tài Khoản",messageText:"",color:"",timeout:3e3,snackbar:!1,searchUser:"",headers:[{text:"Action",align:"left",sortable:!1,value:""},{text:"Email",value:"email",align:"left",sortable:!0},{text:"Roles",value:"roles",align:"left",sortable:!0}],userItems:[],dialogEditRole:!1,itemToEditRole:{},editedIndex:-1,itemRoles:[],dialog:!1,alert:!1,newItem:"",rules:[e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Chỉ được nhập email"]},async beforeCreate(){let e=this;await axios.get("/Setting/GetAccountAsync").then(function(t){e.userItems=t.data}).catch(function(e){console.log(e)}),await axios.get("/Setting/GetRolesAsync").then(function(t){e.itemRoles=t.data}).catch(function(e){console.log(e)})},methods:{mappingEditRoleItem(e){this.editedIndex=this.userItems.indexOf(e),this.itemToEditRole=Object.assign({},e)},async onSave(){if(""!==this.newItem){let e=this;await axios.get("/Setting/CreateNewUserAsync?Email="+this.newItem).then(function(t){"OK"===t.data.status?(e.snackbar=!0,e.messageText="Tạo tài khoản thành công !!!",e.color="success"):(e.snackbar=!0,e.messageText=t.data.message,e.color="error")}).catch(function(t){console.log(t),e.snackbar=!0,e.messageText="Tạo tài khoản lỗi: "+t,e.color="error"})}else this.alert=!0},async ResetMatKhau(e){let t=this;await axios.get("/Setting/ResetMatKhauAsync?Id="+e).then(function(e){"OK"===e.data.status?(t.snackbar=!0,t.messageText="Reset thành công !!!",t.color="success"):(t.snackbar=!0,t.messageText=e.data.message,t.color="error")}).catch(function(e){console.log(e),t.snackbar=!0,t.messageText="Reset lỗi: "+e,t.color="error"})},async KichHoat(e){let t=this;await axios.get("/Setting/KichHoatTaiKhoanAsync?Id="+e).then(function(e){"OK"===e.data.status?(t.snackbar=!0,t.messageText="Kích hoạt tài khoản thành công !!!",t.color="success"):(t.snackbar=!0,t.messageText=e.data.message,t.color="error")}).catch(function(e){console.log(e),t.snackbar=!0,t.messageText="Kích hoạt tài khoản lỗi: "+e,t.color="error"})},async Khoa(e){let t=this;await axios.get("/Setting/KhoaTaiKhoanAsync?Id="+e).then(function(e){"OK"===e.data.status?(t.snackbar=!0,t.messageText="Khóa tài khoản thành công !!!",t.color="success"):(t.snackbar=!0,t.messageText=e.data.message,t.color="error")}).catch(function(e){console.log(e),t.snackbar=!0,t.messageText="Khóa tài khoản lỗi: "+e,t.color="error"})},async onUpdateRole(e){var t=this;await axios({method:"put",url:"/Setting/UpdateRoleAsync",data:{Id:e.id,RoleIds:e.roleIds}}).then(function(e){"OK"===e.data.status?(Object.assign(t.userItems[t.editedIndex],e.data.result),t.snackbar=!0,t.messageText="Cập nhật thành công !!!",t.color="success",t.dialogEditRole=!1):(t.snackbar=!0,t.messageText=e.data.message,t.color="error",t.dialogEditRole=!1)}).catch(function(e){console.log(e),t.snackbar=!0,t.messageText="Cập nhật lỗi: "+e,t.color="error",t.dialogEditRole=!1})}}});