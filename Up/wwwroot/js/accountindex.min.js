var vue=new Vue({el:"#AccountIndex",data:{title:"Quản Lý Tài Khoản",messageText:"",color:"",timeout:3e3,snackbar:!1,searchUser:"",headers:[{text:"Action",align:"left",sortable:!1,value:""},{text:"Email",value:"email",align:"left",sortable:!0},{text:"Roles",value:"roles",align:"left",sortable:!0}],userItems:[],dialogEditRole:!1,itemToEditRole:{},editedIndex:-1,itemRoles:[],dialog:!1,alert:!1,newItem:"",rules:[e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Chỉ được nhập email"]},async beforeCreate(){let e=this;await axios.get("/Setting/GetAccountAsync").then(function(s){e.userItems=s.data}).catch(function(e){console.log(e.response.data.Message)}),await axios.get("/Setting/GetRolesAsync").then(function(s){e.itemRoles=s.data}).catch(function(e){console.log(e.response.data.Message)})},methods:{mappingEditRoleItem(e){this.editedIndex=this.userItems.indexOf(e),this.itemToEditRole=Object.assign({},e)},async onSave(){if(this.dialog=!1,""!==this.newItem){let e=this;await axios.get("/Setting/CreateNewUserAsync?Email="+this.newItem).then(function(s){"OK"===s.data.status?(e.userItems.splice(0,0,s.data.result),e.snackbar=!0,e.messageText="Tạo tài khoản thành công !!!",e.color="success"):(e.snackbar=!0,e.messageText=s.data.message,e.color="error")}).catch(function(s){console.log(s.response.data.Message),e.snackbar=!0,e.messageText="Tạo tài khoản lỗi: "+s.response.data.Message,e.color="error"})}else this.alert=!0},async ResetMatKhau(e){let s=this;await axios.get("/Setting/ResetMatKhauAsync?Id="+e).then(function(e){"OK"===e.data.status?(s.snackbar=!0,s.messageText="Reset thành công, Mật khẩu : M@tkhau@123 !!!",s.color="success"):(s.snackbar=!0,s.messageText=e.data.message,s.color="error")}).catch(function(e){console.log(e.response.data.Message),s.snackbar=!0,s.messageText="Reset lỗi: "+e.response.data.Message,s.color="error"})},async KichHoat(e){let s=this;await axios.get("/Setting/KichHoatTaiKhoanAsync?Id="+e).then(function(e){"OK"===e.data.status?(s.snackbar=!0,s.messageText="Kích hoạt tài khoản thành công !!!",s.color="success"):(s.snackbar=!0,s.messageText=e.data.message,s.color="error")}).catch(function(e){console.log(e.response.data.Message),s.snackbar=!0,s.messageText="Kích hoạt tài khoản lỗi: "+e.response.data.Message,s.color="error"})},async Khoa(e){let s=this;await axios.get("/Setting/KhoaTaiKhoanAsync?Id="+e).then(function(e){"OK"===e.data.status?(s.snackbar=!0,s.messageText="Khóa tài khoản thành công !!!",s.color="success"):(s.snackbar=!0,s.messageText=e.data.message,s.color="error")}).catch(function(e){console.log(e.response.data.Message),s.snackbar=!0,s.messageText="Khóa tài khoản lỗi: "+e.response.data.Message,s.color="error"})},async Xoa(e){let s=this;await axios.get("/Setting/RemoveUserAsync?Id="+e.id).then(function(a){"OK"===a.data.status?(s.userItems.splice(s.userItems.indexOf(e),1),s.snackbar=!0,s.messageText="Xóa tài khoản thành công !!!",s.color="success"):(s.snackbar=!0,s.messageText=a.data.message,s.color="error")}).catch(function(e){console.log(e.response.data.Message),s.snackbar=!0,s.messageText="Xóa tài khoản lỗi: "+e.response.data.Message,s.color="error"})},async onUpdateRole(e){var s=this;await axios({method:"put",url:"/Setting/UpdateRoleAsync",data:{Id:e.id,RoleIds:e.roleIds}}).then(function(e){"OK"===e.data.status?(Object.assign(s.userItems[s.editedIndex],e.data.result),s.snackbar=!0,s.messageText="Cập nhật thành công !!!",s.color="success",s.dialogEditRole=!1):(s.snackbar=!0,s.messageText=e.data.message,s.color="error",s.dialogEditRole=!1)}).catch(function(e){console.log(e.response.data.Message),s.snackbar=!0,s.messageText="Cập nhật lỗi: "+e.response.data.Message,s.color="error",s.dialogEditRole=!1})}}});