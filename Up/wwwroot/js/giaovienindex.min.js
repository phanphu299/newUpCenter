var vue=new Vue({el:"#GiaoVienIndex",data:{title:"Quản Lý Nhân Viên",messageText:"",color:"",timeout:3e3,snackbar:!1,deleteDialog:!1,dialogEdit:!1,dialog:!1,alert:!1,alertEdit:!1,search:"",newItem:{name:"",phone:"",teachingRate:0,tutoringRate:0,basicSalary:0,facebookAccount:"",diaChi:"",initialName:"",cmnd:"",loaiGiaoVien:"",loaiCheDo:"",mucHoaHong:0,ngayLamViecId:"",ngayBatDau:"",ngayKetThuc:"",nganHang:""},itemToDelete:{},itemToEdit:{},editedIndex:-1,alertMessage:"",headers:[{text:"Action",align:"left",sortable:!1,value:""},{text:"Tên Nhân Viên",value:"name",align:"left",sortable:!0},{text:"Vị Trí/Chế Độ",value:"loaiGiaoVien",align:"left",sortable:!0},{text:"Số Điện Thoại",value:"phone",align:"left",sortable:!0},{text:"Teaching Rate",value:"teachingRate",align:"left",sortable:!0},{text:"Tutoring Rate",value:"tutoringRate",align:"left",sortable:!0},{text:"Lương Cơ Bản",value:"basicSalary",align:"left",sortable:!0},{text:"Mức Hoa Hồng",value:"mucHoaHong",align:"left",sortable:!0},{text:"STK Ngân Hàng",value:"nganHang",align:"left",sortable:!0},{text:"Facebook",value:"facebookAccount",align:"left",sortable:!0},{text:"Địa Chỉ",value:"diaChi",align:"left",sortable:!0},{text:"Initial Name",value:"initialName",align:"left",sortable:!0},{text:"CMND",value:"cmnd",align:"left",sortable:!0},{text:"Ngày Làm Việc",value:"ngayLamViec",align:"left",sortable:!0},{text:"Ngày Bắt Đầu",value:"ngayBatDau",align:"left",sortable:!0},{text:"Ngày Kết Thúc",value:"ngayKetThuc",align:"left",sortable:!0},{text:"Ngày Tạo",value:"createdDate",align:"left",sortable:!0},{text:"Người Tạo",value:"createdBy",align:"left",sortable:!0},{text:"Ngày Sửa",value:"updatedDate",align:"left",sortable:!0},{text:"Người Sửa",value:"updatedBy",align:"left",sortable:!0}],khoaHocItems:[],itemLoaiGiaoVien:[],itemLoaiCheDo:[],itemNgayLamViec:[],arrayLoaiNVandCD:[],isShowDatePickerBatDau:!1,isShowDatePickerKetThuc:!1,isShowDatePickerBatDau2:!1,isShowDatePickerKetThuc2:!1},async beforeCreate(){let a=this;await axios.get("/GiaoVien/GetGiaoVienAsync").then(function(e){a.khoaHocItems=e.data}).catch(function(a){console.log(a)}),await axios.get("/Category/GetNgayLamViecAsync").then(function(e){a.itemNgayLamViec=e.data}).catch(function(a){console.log(a)}),await axios.get("/Category/GetLoaiGiaoVienAsync").then(function(e){a.itemLoaiGiaoVien=e.data}).catch(function(a){console.log(a)}),await axios.get("/Category/GetLoaiCheDoAsync").then(function(e){a.itemLoaiCheDo=e.data}).catch(function(a){console.log(a)})},filters:{truncate:function(a,e,t){return a.substring(0,e)+t}},methods:{async onAddLoaiNVCD(){if(""!==this.newItem.loaiGiaoVien&&""!==this.newItem.loaiCheDo){let a=!1;this.arrayLoaiNVandCD.map(e=>{e.loaiGiaoVien.loaiGiaoVienId===this.newItem.loaiGiaoVien.loaiGiaoVienId&&(a=!0)}),!1===a&&this.arrayLoaiNVandCD.push({loaiGiaoVien:this.newItem.loaiGiaoVien,loaiCheDo:this.newItem.loaiCheDo})}else this.snackbar=!0,this.messageText="Phải chọn cả loại nhân viên và chế độ trước khi thêm !!!",this.color="error"},async onXoaLoaiNVCD(a){this.arrayLoaiNVandCD=this.arrayLoaiNVandCD.filter(e=>e.loaiGiaoVien.loaiGiaoVienId!==a.loaiGiaoVien.loaiGiaoVienId)},async onAddLoaiNVCDForEdit(a){if(void 0!==this.itemToEdit.loaiGiaoVienId&&void 0!==this.itemToEdit.loaiCheDoId){let e=!1;a.loaiNhanVien_CheDo.map(a=>{a.loaiGiaoVien.loaiGiaoVienId===this.itemToEdit.loaiGiaoVienId.loaiGiaoVienId&&(e=!0)}),!1===e&&a.loaiNhanVien_CheDo.push({loaiGiaoVien:this.itemToEdit.loaiGiaoVienId,loaiCheDo:this.itemToEdit.loaiCheDoId})}else this.snackbar=!0,this.messageText="Phải chọn cả loại nhân viên và chế độ trước khi thêm !!!",this.color="error"},async onXoaLoaiNVCDForEdit(a){this.itemToEdit.loaiNhanVien_CheDo=this.itemToEdit.loaiNhanVien_CheDo.filter(e=>e.loaiGiaoVien.loaiGiaoVienId!==a.loaiGiaoVien.loaiGiaoVienId)},mappingEditItem(a){if(this.editedIndex=this.khoaHocItems.indexOf(a),this.itemToEdit=Object.assign({},a),""!==this.itemToEdit.ngayBatDau){let[a,e,t]=this.itemToEdit.ngayBatDau.split("/");this.itemToEdit.ngayBatDau=t+"-"+e+"-"+a}if(""!==this.itemToEdit.ngayKetThuc){let[a,e,t]=this.itemToEdit.ngayKetThuc.split("/");this.itemToEdit.ngayKetThuc=t+"-"+e+"-"+a}},async onUpdate(a){if(""===a.ngayLamViec||""===a.ngayBatDau||""===a.name||""===a.phone||""===a.diaChi||""===a.initialName||""===a.cmnd||""===a.basicSalary)this.alertMessage="Không được bỏ trống",this.alertEdit=!0;else if(isNaN(a.mucHoaHong)||isNaN(a.teachingRate)||isNaN(a.tutoringRate)||isNaN(a.basicSalary))this.alertMessage="Teaching Rate, Tutoring Rate, Basic Salary và Mức Hoa Hồng chỉ được nhập số",this.alertEdit=!0;else if(0===a.loaiNhanVien_CheDo.length)this.snackbar=!0,this.messageText="Phải chọn loại nhân viên và chế độ !!!",this.color="error";else{let e=this;await axios({method:"put",url:"/giaovien/UpdateGiaoVienAsync",data:{GiaoVienId:a.giaoVienId,Name:a.name,Phone:a.phone,TeachingRate:a.teachingRate,TutoringRate:a.tutoringRate,BasicSalary:a.basicSalary,FacebookAccount:a.facebookAccount,DiaChi:a.diaChi,InitialName:a.initialName,CMND:a.cmnd,LoaiNhanVien_CheDo:a.loaiNhanVien_CheDo,MucHoaHong:a.mucHoaHong,NgayBatDau:a.ngayBatDau,NgayKetThuc:a.ngayKetThuc,NgayLamViecId:a.ngayLamViecId,NganHang:a.nganHang}}).then(function(a){console.log(a),"OK"===a.data.status?(Object.assign(e.khoaHocItems[e.editedIndex],a.data.result),e.snackbar=!0,e.messageText="Cập nhật thành công !!!",e.color="success",e.dialogEdit=!1):(e.snackbar=!0,e.messageText=a.data.message,e.color="error",e.dialogEdit=!1)}).catch(function(a){console.log(a),e.snackbar=!0,e.messageText="Cập nhật lỗi: "+a,e.color="error",e.dialogEdit=!1})}},async onSave(a){if(""===this.newItem.ngayLamViec||""===this.newItem.ngayBatDau||""===this.newItem.name||""===this.newItem.phone||""===this.newItem.diaChi||""===this.newItem.initialName||""===this.newItem.cmnd)this.alertMessage="Không được bỏ trống",this.alert=!0;else if(isNaN(this.newItem.mucHoaHong)||isNaN(this.newItem.teachingRate)||isNaN(this.newItem.tutoringRate)||isNaN(this.newItem.basicSalary))this.alertMessage="Teaching Rate, Tutoring Rate, Basic Salary và Mức Hoa Hồng chỉ được nhập số",this.alert=!0;else if(0===this.arrayLoaiNVandCD.length)this.snackbar=!0,this.messageText="Phải chọn loại nhân viên và chế độ !!!",this.color="error";else{this.dialog=!1;let a=this;await axios({method:"post",url:"/giaovien/CreateGiaoVienAsync",data:{Name:a.newItem.name,Phone:a.newItem.phone,TeachingRate:a.newItem.teachingRate,TutoringRate:a.newItem.tutoringRate,BasicSalary:a.newItem.basicSalary,FacebookAccount:a.newItem.facebookAccount,DiaChi:a.newItem.diaChi,InitialName:a.newItem.initialName,CMND:a.newItem.cmnd,LoaiNhanVien_CheDo:a.arrayLoaiNVandCD,MucHoaHong:a.newItem.mucHoaHong,NgayBatDau:a.newItem.ngayBatDau,NgayKetThuc:a.newItem.ngayKetThuc,NgayLamViecId:a.newItem.ngayLamViecId,NganHang:a.newItem.nganHang}}).then(function(e){console.log(e),"OK"===e.data.status?(a.khoaHocItems.splice(0,0,e.data.result),a.snackbar=!0,a.messageText="Thêm mới thành công !!!",a.color="success",a.newItem.name="",a.newItem.phone="",a.newItem.teachingRate=0,a.newItem.tutoringRate=0,a.newItem.basicSalary=0,a.newItem.facebookAccount="",a.newItem.diaChi="",a.newItem.initialName="",a.newItem.cmnd="",a.arrayLoaiNVandCD=[],a.newItem.loaiGiaoVien="",a.newItem.loaiCheDo="",a.newItem.mucHoaHong=0,a.newItem.ngayLamViecId="",a.newItem.ngayBatDau="",a.newItem.ngayKetThuc="",a.newItem.nganHang=""):(a.snackbar=!0,a.messageText=e.data.message,a.color="error")}).catch(function(e){console.log(e),a.snackbar=!0,a.messageText="Thêm mới lỗi: "+e,a.color="error"})}},async onDelete(a){let e=this;await axios({method:"delete",url:"/giaovien/DeleteGiaoVienAsync",data:{GiaoVienId:a.giaoVienId}}).then(function(t){console.log(t),"OK"===t.data.status?(e.khoaHocItems.splice(e.khoaHocItems.indexOf(a),1),e.snackbar=!0,e.messageText="Xóa thành công !!!",e.color="success",e.deleteDialog=!1):(e.snackbar=!0,e.messageText=t.data.message,e.color="error")}).catch(function(a){console.log(a),e.snackbar=!0,e.messageText="Xóa lỗi: "+a,e.color="error"})}}});