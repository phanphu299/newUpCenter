var vue = new Vue({ el: "#ExportDiemDanhIndex", data: { title: "Export Điểm Danh", messageText: "", color: "", timeout: 3e3, snackbar: !1, deleteDialog: !1, dialog: !1, selectedLopHoc: "", selectedThang: "", selectedNam: "", itemThang: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"], itemKhuyenMai: ["5", "10", "15", "20", "25", "30", "35", "40", "45", "50"], itemNam: [(new Date).toISOString().substr(0, 4) - 2, (new Date).toISOString().substr(0, 4) - 1, (new Date).toISOString().substr(0, 4) - 0], itemLopHoc: [] }, async beforeCreate() { let e = this; await axios.get("/LopHoc/GetAvailableLopHocAsync").then(function (t) { e.itemLopHoc = t.data }).catch(function (e) { console.log(e) }) }, methods: { forceFileDownload(e) { const t = window.URL.createObjectURL(new Blob([e.data])), o = document.createElement("a"); o.href = t, o.setAttribute("download", "diemdanh_" + this.selectedLopHoc.name + "_T" + this.selectedThang + "-" + this.selectedNam + ".xlsx"), document.body.appendChild(o), o.click() }, async onExport() { let e = this; "" !== this.selectedLopHoc && "" !== this.selectedNam && "" !== this.selectedThang ? await axios({ url: "/DiemDanh/ExportDiemDanh?LopHocId=" + e.selectedLopHoc.lopHocId + "&month=" + e.selectedThang + "&year=" + e.selectedNam, method: "get", responseType: "blob" }).then(function (t) { e.forceFileDownload(t) }).catch(function (e) { console.log(e) }) : (e.snackbar = !0, e.messageText = "Phải chọn Lớp Học, Tháng và Năm trước khi export!!!", e.color = "error", e.dialogEdit = !1) } } });