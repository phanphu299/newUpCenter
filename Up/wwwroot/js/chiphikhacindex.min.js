var vue=new Vue({el:"#ChiPhiKhacIndex",data:{title:"Quản Lý Chi Phí Khác",messageText:"",color:"",timeout:3e3,snackbar:!1,deleteDialog:!1,isShowDatePicker:!1,isShowDatePicker2:!1,dialog:!1,alert:!1,alertEdit:!1,rules:[e=>/^[0-9]*$/.test(e)||"Chỉ được nhập số"],mustNumber:e=>!isNaN(e)||"Chỉ được nhập số",alertMessage:"",search:"",newItem:{name:"",gia:"",ngayChiPhi:(new Date).toISOString().substr(0,10)},itemToDelete:{},dialogEdit:!1,editedIndex:-1,headers:[{text:"Action",align:"left",sortable:!1,value:""},{text:"Tên",value:"name",align:"left",sortable:!1},{text:"Giá",value:"gia",align:"left",sortable:!1},{text:"Ngày Chi Phí",value:"_NgayChiPhi",align:"left",sortable:!1},{text:"Ngày Tạo",value:"createdDate",align:"left",sortable:!1},{text:"Người Tạo",value:"createdBy",align:"left",sortable:!1},{text:"Ngày Sửa",value:"updatedDate",align:"left",sortable:!1},{text:"Người Sửa",value:"updatedBy",align:"left",sortable:!1}],khoaHocItems:[],itemToEdit:{}},async beforeCreate(){let e=this;await axios.get("/category/GetOtherExpenseAsync").then(function(t){e.khoaHocItems=t.data}).catch(function(e){console.log(e.response.data.Message)})},methods:{formatNumber:e=>e.toLocaleString("it-IT",{style:"currency",currency:"VND"}),mappingEditItem(e){if(this.itemToEdit=Object.assign({},e),this.editedIndex=this.khoaHocItems.indexOf(e),""!==this.itemToEdit._NgayChiPhi){let[e,t,a]=this.itemToEdit._NgayChiPhi.split("/");this.itemToEdit.ngayChiPhi=a+"-"+t+"-"+e}},async onUpdate(e){let t=this;""===e.name?(this.alertMessage="Không được bỏ trống",this.alertEdit=!0):isNaN(e.gia)||""===e.gia?(this.alertMessage="Chỉ được nhập số",this.alertEdit=!0):(await axios({method:"put",url:"/category/UpdateOtherExpenseAsync",data:{Name:e.name,Gia:e.gia,NgayChiPhi:e.ngayChiPhi,ChiPhiKhacId:e.chiPhiKhacId}}).then(function(e){"OK"===e.data.status?(t.snackbar=!0,t.messageText="Cập nhật thành công !!!",t.color="success",Object.assign(t.khoaHocItems[t.editedIndex],e.data.result)):(t.snackbar=!0,t.messageText=e.data.message,t.color="error")}).catch(function(e){console.log(e.response.data.Message),t.snackbar=!0,t.messageText="Cập nhật lỗi: "+e.response.data.Message,t.color="error"}),t.dialogEdit=!1)},async onSave(e){if(""===this.newItem.name)this.alertMessage="Không được bỏ trống",this.alert=!0;else if(isNaN(this.newItem.gia)||""===this.newItem.gia)this.alertMessage="Chỉ được nhập số",this.alert=!0;else{this.dialog=!1;let e=this;await axios({method:"post",url:"/category/CreateOtherExpenseAsync",data:{Name:e.newItem.name,Gia:e.newItem.gia,NgayChiPhi:e.newItem.ngayChiPhi}}).then(function(t){this.alert=!1,"OK"===t.data.status?(e.khoaHocItems.splice(0,0,t.data.result),e.snackbar=!0,e.messageText="Thêm mới thành công !!!",e.color="success",e.newItem.name="",e.newItem.gia="",e.newItem.ngayChiPhi=(new Date).toISOString().substr(0,10)):(e.snackbar=!0,e.messageText=t.data.message,e.color="error")}).catch(function(t){console.log(t.response.data.Message),e.snackbar=!0,e.messageText="Thêm mới lỗi: "+t.response.data.Message,e.color="error"})}},async onDelete(e){let t=this;await axios({method:"delete",url:"/category/DeleteOtherExpenseAsync",data:{ChiPhiKhacId:e.chiPhiKhacId}}).then(function(a){"OK"===a.data.status?(t.khoaHocItems.splice(t.khoaHocItems.indexOf(e),1),t.snackbar=!0,t.messageText="Xóa thành công !!!",t.color="success",t.deleteDialog=!1):(t.snackbar=!0,t.messageText=a.data.message,t.color="error")}).catch(function(e){console.log(e.response.data.Message),t.snackbar=!0,t.messageText="Xóa lỗi: "+e.response.data.Message,t.color="error"})}}});