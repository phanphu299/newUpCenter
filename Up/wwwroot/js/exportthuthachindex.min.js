var vue=new Vue({el:"#ExportThuThachIndex",data:{title:"Export Thử Thách",messageText:"",color:"",timeout:3e3,snackbar:!1,selectedThuThach:"",itemThuThach:[]},async beforeCreate(){let e=this;await axios.get("/ThuThach/GetThuThachAsync").then(function(h){e.itemThuThach=h.data}).catch(function(e){console.log(e.response.data.Message)})},methods:{forceFileDownload(e){const h=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=h,t.setAttribute("download","thuThach_"+this.selectedThuThach.name+".xlsx"),document.body.appendChild(t),t.click()},async onExport(){let e=this;""!==this.selectedThuThach?await axios({url:"/ThuThach/ExportThuThach?ThuThachId="+e.selectedThuThach.thuThachId,method:"get",responseType:"blob"}).then(function(h){e.forceFileDownload(h)}).catch(function(e){console.log(e.response.data.Message)}):(e.snackbar=!0,e.messageText="Phải chọn Thử Thách trước khi export!!!",e.color="error",e.dialogEdit=!1)}}});